<!doctype html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Current Hourly Forecast</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>

<body>
<div class="container mt-5">
    <h1 class="text-center mb-4">Current Forecast in Boston</h1>
    <div id="currentHourlyForecast" class="row"></div>
</div>

<!-- Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
	var firebaseConfig = {
					apiKey: "AIzaSyBnfXfi-VzYYfbdmD_0S91TUKo3a975G7g",
					authDomain: "REPLACE_WITH_YOUR_OWN",
					databaseURL: "https://ps70week9-default-rtdb.firebaseio.com",
					projectId: "REPLACE_WITH_YOUR_OWN",
					storageBucket: "REPLACE_WITH_YOUR_OWN",
					messagingSenderId: "REPLACE_WITH_YOUR_OWN",
					appId: "REPLACE_WITH_YOUR_OWN"
				};
					// Initialize Firebase
				firebase.initializeApp(firebaseConfig);

				// Get a database reference to our blog
				var ref = firebase.database().ref("/");

    function fetchCurrentHourlyForecast() {
        const apiUrl = 'https://api.weather.gov/points/42.3601,-71.0589';

        fetch(apiUrl)
            .then(response => response.json())
            .then(data => {
                // Extract the forecast URL from the JSON response
                const forecastUrl = data.properties.forecastHourly;

                // Fetch the hourly forecast data from the forecast URL
                fetch(forecastUrl)
                    .then(response => response.json())
                    .then(data => {
                        // Extract the current hourly forecast period from the JSON response
                        const currentHourlyForecast = data.properties.periods[0];


						// trying something
						temp = currentHourlyForecast.temperature
						description = currentHourlyForecast.shortForecast
						document.getElementById("test").innerHTML = temp;
						document.getElementById("short").innerHTML = description;

						
						if(temp >= 40){
							firebase.database().ref("User").set({
								LED_STATUS: "ON"
							});
						}

                        // Update the HTML content of the current hourly forecast container
                        document.getElementById('currentHourlyForecast').innerHTML = forecastHtml;
                    })
                    .catch(error => console.error('Error fetching hourly forecast:', error));
            })
            .catch(error => console.error('Error fetching forecast URL:', error));
    }

    // Call the fetchCurrentHourlyForecast function when the page loads
    window.onload = fetchCurrentHourlyForecast;

</script>

<h4>TESTING: <span id="test"></span> Â°F</h4>
<p>description: <span id="short"></span></p>


</body>
</html>