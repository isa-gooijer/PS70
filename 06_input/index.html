<!-- MAIN PAGE -->

<!DOCTYPE html>
<!-- Start of html doc -->
<html lang="en">
  <!-- Container for meta data -->
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <!-- Mobile-optimized website: https://developer.mozilla.org/en-US/docs/Web/HTML/Viewport_meta_tag -->
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- JAVASCRIPT -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

        <!-- STYlE:
            Import documentation from Bootstrap; at https://getbootstrap.com/docs/5.3/getting-started/introduction/
            alternative themes at https://bootswatch.com/ -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        <!-- Import own CSS style sheet -->
        <link href="../bootstrap.css" rel="stylesheet">
        <link href="../style.css" rel="stylesheet">

        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/arduino-light.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/arduino.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
        <!-- Title of page -->
        <title>PS70_06_Electronic Input Devices</title>
    </head>


    <body>
        <nav class="navbar navbar-expand-lg bg-body-tertiary bg-dark border-bottom border-body" data-bs-theme="dark">
        <div class="container-fluid">
            <a class="navbar-brand mb-0 h1" href="../index.html">HOME</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                <a class="nav-link" href="../about.html">About</a>
                </li>
                <li class="nav-item">
                <a class="nav-link" href="../finalproject/index.html">Final Project</a>
                </li>
                <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="../assignments.html" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    Assignments
                </a>
                <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="../01_intro/index.html">01 - Intro</a></li>
                    <li><a class="dropdown-item" href="../02_2Ddesign/index.html">02 - 2D Design & Cutting</a></li>
                    <li><a class="dropdown-item" href="../03_fabrication/index.html">03 - Hand Tools & Fabrication</a></li>
                    <li><a class="dropdown-item" href="../04_microcontroller/index.html">04 - Microcontrollers</a></li>
                    <li><a class="dropdown-item" href="../05_3Ddesign/index.html">05 - 3D Design & Printing</a></li>
                    <li><a class="dropdown-item" href="../06_input/index.html">06 - Electronic Input Devices</a></li>
                    <li><a class="dropdown-item" href="../07_output/index.html">07 - Electronic Output Devices</a></li>
                    <li><a class="dropdown-item" href="../08_CNC/index.html">08 - CNC Miling</a></li>
                    <li><a class="dropdown-item" href="../09_networking/index.html">09 - Radio, WiFi & Bluetooth</a></li>
                    <li><a class="dropdown-item" href="../10_machine/index.html">10 - Machine Building & Effectors</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item" href="../finalproject/index.html">Final Project</a></li>
                </ul>
                </li>
            </ul>
            </div>
        </div>
        </nav>


        <div class="container-fluid text-center">
            <div class="row">
                <div class="col">
                    <h1>WEEK 6: Electronic Input Devices</h1>
                    <h2></h2>
                    <h4><i>Arduino</i></h4>
                    <b>Assignment:</b>
                    <a href="https://nathanmelenbrink.github.io/ps70/06_input/index.html" target="_blank">PS70 website - week 4</a>
                </div>
            </div>
        </div>
        <div class="container-fluid text-start">
            <div class="row justify-content-center">
                <div class="col-6">
                    <p><u>Program an Arduino to do something:</u>
                        <ol>
                            <li>Make a <b>capacitive sensor</b> to measure a physical quantity with your microcontroller.
                                Avoid the delay() function; use timers instead.</li>
                            <li>Configure and use <b>another sensor</b> (temperature, microphone, etc.). Include at least one output device
                                (it could just be an LED).Avoid the delay() function and use the C++ class structure.</li>
                            <li>Include schematics of each sensor.</li>
                            <li><b>Calibrate</b> each sensor by plotting points on a graph. Discuss the relationship between the signals
                                recorded by your microcontroller and the physical quantities that you're measuring (i.e., it is
                                likely not a linear relationship).</li>
                            <li>Prepare <b>CAD files for CNC week</b>. Consider either 2D DXF files for routing sheet material (like
                                plywood or OSB), or 3D STL files to mill out a (2.5D) shape.</li>
                        </ol>
                    </p> 
                </div>
            </div>
        </div>
        <div class="container-fluid text-start">
            <div class="row justify-content-center">
                <div class="col-8">
                    <h2>INPUT DEVICES!</h2>
                    <p>Set up a temperature and humidity sensor which I can use for my final project</p>
                    <ul>
                        <li><a href="https://sensorkit.arduino.cc/sensorkit/module/lessons/lesson/08-the-temperature-sensor" target="_blank">DHT11 sensor</a></li>
                        <li><a href="https://www.instructables.com/TMP36-Temperature-Sensor-Arduino-Tinkercad/">Tmp36 Tinkercad</a></li>
                    </ul>
                    <p>Set up a <b>soil moisture sensor</b> which I can use for my final project:</p>
                        The LED turns of when the moisture level is below a certain point
                    <p><video controls class="img-fluid" style="width:50%; height:50%; transform: rotate(90deg);">
                        <source src="./Moisture_sensor.MOV" type="video/mp4">
                    </video></p>
                    <script src="https://strapdownjs.com/v/0.2/strapdown.js"> </script>
                    <h4>ARDUINO CODE</h4>
                    <xmp>
                int LED = 3;
                int SM_Sensor = A0;
                int Max_Moist = 850;
                int MoistureValue;
                int Moist_perc; 

                void setup() {
                pinMode(LED, OUTPUT); // LED pin, digital signal
                pinMode (SM_Sensor, INPUT); // Soil Moisture Sensor pin, analog signal
                Serial.begin(9600);
                }

                void   loop() {
                MoistureValue = analogRead(SM_Sensor); //Keep renewing the readings for the current moisture level
                delay(1000); //Short delay to not overload the program
                Serial.println(MoistureValue); //Print moisture level: 0-1023

                Moist_perc = ((float)MoistureValue/(float)Max_Moist) * 100;
                // get moisture value in percentage:  current/max * 100
                delay(1000);
                Serial.println(Moist_perc);  //Print moisture percentage: 0-100

                if(MoistureValue <= 500){ //If the moisture is below 10%
                    digitalWrite(LED, HIGH);
                    delay(100);
                }
                else {
                    digitalWrite(LED, LOW);
                    delay(100);
                }
                }

                //850 is max value --> 100%
                // 0 --> 100%
                    </xmp>
                <p>Make a capacitive sensor to measure how much water is left in the water tank that's going to be used for the 
                    watering system. When the tank is (nearly) empty LED turns on.</p>
                <h3>UPDATE: 03/19/2024</h3>
                <p>I tried to get the soil moisture sensor to work without using delay(). I used the millis() function
                    and created an arduino class for this. At first it didn't work, but that was because I had
                    to include <i>Serial.begin(9600);</i> in the void setup(). After that it worked.</p>
                <u>New Arduino Code:</u>
                <xmp>
                // SOIL MOISTURE - LED --> OOP & W/O DELAY

                class SoilMoist {
                // CLASS MEMBER VARIABLES
                // variables that are initialized at startup
                int SM_pin; //soil moisture sensor pin
                int maxMoistValue; // maximum soil moisture value.
                int interval; // interval at which soil moisture values is read
                
                
                // variables that maintain current state
                int currentMoistValue; // current soil moisture value.
                unsigned long lastUpdate; // last update (in milliseconds)

                public:
                SoilMoist(int pin, int max, int Int){
                    SM_pin = pin;
                    maxMoistValue = max;
                    interval = Int;

                    lastUpdate = 0; // start clock at zero
                }

                void Update(){
                    // check to see if it's time to read of the soil moisture value
                    if(millis() - lastUpdate >= interval){
                    lastUpdate = millis();
                    currentMoistValue = analogRead(SM_pin);
                    Serial.println(currentMoistValue);
                    }
                }
                };

                SoilMoist sm1(A0, 850, 1000); // pin = A0; max = 850; interval = 1000 ms.

                void setup() {
                Serial.begin(9600);
                }

                void loop() {
                sm1.Update();
                }
                </xmp>
                </div>
            </div>
        </div>
    </body>
</html>
